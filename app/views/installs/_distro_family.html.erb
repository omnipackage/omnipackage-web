<%# locals: (family:, repos:) -%>

<%- acc_id = ->(distro_id) { "collapse-accordion-#{distro_id.gsub(/[^0-9a-z]/i, '-')}" } %>

<div class="row">

  <div class="col-md-auto">
    <%= render partial: 'layouts/distro_icon', locals: { family: family, size: 64 } %>
  </div>

  <div class="col-md-11">

    <div class="accordion" id="accordion-<%= family %>">

      <% repos.sort_by { |i| i.distro.name }.each do |repo| %>

        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#<%= acc_id.call(repo.distro.id) %>" aria-expanded="false" aria-controls="<%= acc_id.call(repo.distro.id) %>">
              <%= repo.distro.name %>
            </button>
          </h2>

          <div id="<%= acc_id.call(repo.distro.id) %>" class="accordion-collapse collapse" data-bs-parent="#accordion-<%= family %>">
            <div class="accordion-body">
              <strong>Package installation steps for <%= repo.distro.name %></strong>
              <div class="bg-body-tertiary p-2 rounded-2">
                <pre><%= repo.installable_cli %></pre>
              </div>
              <div class="btn-group" role="group" aria-label="installation step manage">
                <button data-action="clipboard#copy" class="btn btn-link btn-sm">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </div>

      <% end %>

    </div>

  </div>

</div>
