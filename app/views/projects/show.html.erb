<h1>Project <%= @project.name %></h1>

<p>
  <strong>Sources:</strong> <span class="badge bg-secondary"><%= @project.sources_kind %></span> <span class="font-monospace"><%= @project.sources_location %></span>
  <% if @project.sources_verified? %>
    <span class="badge bg-success">verified <%= @project.sources_verified_at %></span>
  <% else %>
    <span class="badge bg-danger">unverified</span>
  <% end %>
  <span class="font-monospace"><%= @project.sources_subdir %></span>
  <%= button_to 'Trigger fetch sources', project_sources_path(@project.id), method: :post, class: 'btn btn-outline-primary btn-sm' %>
</p>

<p>
  <strong>SSH public key</strong>
  <pre class="pre-line-wrap"><%= @project.sources_public_ssh_key %></pre>
  <%= button_to 'Generate new keys', project_ssh_keys_path(@project.id), method: :post, class: 'btn btn-outline-primary btn-sm', form: { data: { turbo_confirm: "Are you sure?" } } %>
</p>

<p>
  <strong>Build config</strong>
  <% if @project.sources_verified? %>
    <pre><%= @project.sources_tarball.config.pretty_inspect %></pre>
    <%= link_to 'Download cached sources tarball', project_sources_path(@project.id), class: 'btn btn-link' %>
  <% end %>
</p>

<p>
  <% if @project.sources_verified? %>
    <strong>Distros</strong>
    <% @project.distros.each do |d| %>
      <span class="badge text-bg-secondary"><%= d.fullname %></span>
    <% end %>

    <%= button_to 'Trigger build', tasks_path(project_id: @project.id), method: :post, class: 'btn btn-outline-primary btn-sm' %>
  <% end %>
</p>

<br>
<p>
  <%= link_to 'Edit project', edit_project_path(@project.id), class: 'btn btn-link' %>
  <%= link_to 'Back to projects list', projects_path, class: 'btn btn-link' %>
</p>
